# デッキメタデータ編集機能

YGO Deck Helperのデッキ編集画面では、デッキに関する詳細情報（メタデータ）を編集できます。

## メタデータとは

デッキメタデータは、デッキに付与する追加情報です：
- デッキ名
- 公開/非公開設定
- デッキタイプ（テーマ/コンセプト）
- デッキスタイル（アグロ/コントロール等）
- カテゴリ（ビートダウン/コンボ等）
- タグ（キーワード）
- デッキ説明（戦略・使い方）

これらの情報を設定することで、デッキ検索やフィルタリングが便利になります。

## メタデータタブの開き方

1. デッキ編集画面（Vue Edit）を開く
2. 右側パネルの上部にある「Metadata」タブをクリック
3. メタデータ編集UIが表示されます

**タブの順序:**
- Card（デフォルト）: カード情報表示
- Search: カード検索
- Metadata: デッキメタデータ編集

## UI構成

### 1行目: 基本設定
- **公開/非公開スイッチ**（左側）
  - ON: デッキを公開（他のユーザーが検索・閲覧可能）
  - OFF: デッキを非公開（自分のみ閲覧可能）
- **デッキタイプ選択**（アイコンボタン）
  - デッキのテーマやコンセプトを選択
  - 例: テーマデッキ、ファンデッキ、トーナメントデッキ
- **デッキスタイル選択**（ボタン）
  - デッキの戦略スタイルを選択
  - 例: アグロ、コントロール、ミッドレンジ、コンボ

### 2行目: タグ・カテゴリ選択
- **Tagボタン**（左側）
  - クリックするとタグ選択ダイアログが開きます
  - プリセットタグから選択可能
- **Categoryボタン**（右側）
  - クリックするとカテゴリ選択ダイアログが開きます
  - ビートダウン、コンボ、ロックバーン等から選択

### 3行目: 選択済みタグ・カテゴリ
- 選択したタグとカテゴリがチップ形式で表示されます
- チップ右側の「×」ボタンで削除可能
- 小さなチップサイズで多数の選択も見やすく表示

### 4行目: デッキ説明
- **見出し**: 「説明」
- **文字数カウンター**: 現在の文字数/1000
- **テキストエリア**: デッキの戦略や使い方を記述
  - 最大1000文字
  - 複数行入力可能
  - 高さは親要素に合わせて拡大

## 各項目の詳細

### 公開/非公開設定

**公開（Public）:**
- デッキが検索結果に表示される
- URLを知っているユーザーが閲覧可能
- 公式デッキリストに掲載される可能性あり

**非公開（Private）:**
- 検索結果に表示されない
- URLを知っているユーザーでも閲覧不可
- 自分のデッキリストにのみ表示

**変更方法:**
- スイッチボタンをクリックしてON/OFF切り替え
- スイッチ内に「Public」「Private」のテキスト表示

### デッキタイプ

デッキの主要なテーマやコンセプトを選択します。

**主なデッキタイプ:**
- **テーマデッキ**: 特定のカードシリーズやテーマを使用
- **ファンデッキ**: 楽しさを重視したカジュアルデッキ
- **トーナメントデッキ**: 競技性重視の構築
- **メタデッキ**: 環境上位デッキに対抗する構成
- **練習用デッキ**: 操作練習や戦術研究用

**選択方法:**
1. デッキタイプボタン（アイコン表示）をクリック
2. ドロップダウンメニューが開く
3. 一覧から選択してクリック

### デッキスタイル

デッキの戦略的なプレイスタイルを選択します。

**主なデッキスタイル:**
- **アグロ（Aggro）**: 序盤から攻撃的に攻める速攻型
- **コントロール（Control）**: 相手の行動を制限しながら戦う
- **ミッドレンジ（Midrange）**: バランス型、中盤で優位を取る
- **コンボ（Combo）**: 特定のカード組み合わせで勝利を狙う
- **ビートダウン（Beatdown）**: 高打点モンスターで殴る
- **バーン（Burn）**: 効果ダメージで相手のLPを削る
- **ロック（Lock）**: 相手の行動を封じる

**選択方法:**
1. デッキスタイルボタンをクリック
2. ドロップダウンメニューが開く
3. 一覧から選択してクリック

### カテゴリ

デッキの細かな分類やサブジャンルを設定します。複数選択可能です。

**主なカテゴリ:**
- ビートダウン
- コンボ
- ロックバーン
- パーミッション
- ワンキル（OTK）
- エクストラ依存
- 除去主体
- 特殊召喚封じ

**選択方法:**
1. Categoryボタンをクリック
2. カテゴリ選択ダイアログが開く
3. **検索**: 上部の検索欄でカテゴリを絞り込み
4. **Filter**: フィルターボタンで条件指定（実装予定）
5. **選択**: グリッド表示されたカテゴリをクリックして選択
6. **選択済み確認**: ダイアログ上部にチップ表示
7. **確定**: ダイアログを閉じて確定

**ダイアログの特徴:**
- right-area範囲外に表示（画面からはみ出さない）
- 検索アイコンはMDI-icon使用
- グリッド表示で見やすい

### タグ

デッキに関するキーワードを複数設定できます。検索時に便利です。

**タグの例:**
- 初心者向け
- 低予算
- 高難易度
- トーナメント向け
- ソリティア
- 準制限級
- 環境デッキ

**選択方法:**
1. Tagボタンをクリック
2. タグ選択ダイアログが開く（Categoryと同様の仕様）
3. プリセットタグから選択
4. 複数選択可能

**注意:**
- タグマスターデータは自動取得（初回のみ）
- カスタムタグの追加は現在未対応

### デッキ説明

デッキのコンセプト、戦略、使い方などを自由に記述できます。

**記入内容の例:**
- デッキコンセプトの説明
- 主要なコンボルート
- マリガン基準
- プレイングのコツ
- 有利/不利対面の情報
- サイドデッキの役割

**制限:**
- 最大1000文字
- 改行可能（複数行入力対応）
- 文字数は画面上部にリアルタイム表示

**入力方法:**
1. テキストエリアをクリック
2. テキストを入力
3. 自動保存（実装状況により異なる）

## 操作ガイド

### メタデータの保存

1. 各項目を編集
2. 保存ボタンをクリック（または自動保存）
3. 「保存しました」メッセージが表示される

**保存タイミング:**
- 明示的な保存ボタン押下
- または自動保存（実装状況による）

### 選択済みタグ・カテゴリの削除

1. 3行目のチップ表示を確認
2. 削除したいチップの「×」ボタンをクリック
3. 即座に削除される

### デッキタイプ・スタイルの変更

1. 現在の設定がボタンに表示されている
2. ボタンをクリック
3. ドロップダウンメニューから別の選択肢を選ぶ
4. 選択肢をクリックして確定

## カラーテーマ対応

メタデータUIはライトテーマとダークテーマの両方に対応しています。

**ライトテーマ:**
- 白背景、黒文字
- 見やすいコントラスト

**ダークテーマ:**
- ダーク背景、明るい文字
- 目に優しい配色

**切り替え方法:**
- 設定画面でテーマを選択
- 即座に全UIに反映

## トラブルシューティング

### タグ・カテゴリが選択できない
- タグマスターデータの取得に失敗している可能性
- ページをリロードして再度試してください
- それでも解決しない場合は開発者に報告

### 保存できない
- ネットワーク接続を確認
- ログインセッションが切れている可能性
- ページをリロードして再度ログイン

### 文字数制限を超えた
- デッキ説明は1000文字までです
- 現在の文字数を確認してください
- 不要な部分を削除してください

### カテゴリダイアログが画面からはみ出す
- ダイアログは自動的に位置調整されます
- ブラウザのズーム設定を確認してください
- ウィンドウサイズを調整してください

## よくある質問

**Q: メタデータは必須ですか？**
A: いいえ、任意です。ただし公開する場合は設定を推奨します。

**Q: メタデータは後から変更できますか？**
A: はい、いつでも編集・保存できます。

**Q: タグとカテゴリの違いは？**
A: カテゴリは戦略的な分類、タグは自由なキーワードです。

**Q: 公開/非公開は何回でも切り替えられますか？**
A: はい、制限なく切り替え可能です。

**Q: デッキ説明に画像を挿入できますか？**
A: 現在未対応です。テキストのみです。

**Q: カスタムタグは作成できますか？**
A: 現在未対応です。プリセットタグのみ選択可能です。

**Q: メタデータはエクスポートされますか？**
A: PNG形式のエクスポートには一部メタデータが含まれます。CSV/TXTには含まれません。

## 技術情報

### データ構造
```typescript
interface DeckMetadata {
  name: string;
  isPublic: boolean;
  deckType?: string;
  deckStyle?: string;
  categories: string[];
  tags: string[];
  description: string;
}
```

### ストレージ
- メタデータはサーバーに保存されます
- ローカルストレージにキャッシュされる場合があります

### API連携
- タグマスターデータ: デッキ検索ページから自動取得
- カテゴリマスターデータ: 同上
- 保存: デッキ保存APIを使用

## 参考資料
- [インポート・エクスポート機能](./import-export.md)
- [デッキ編集機能の概要](../README.md)
- [開発者向け: データモデル](../dev/data-models.md)
