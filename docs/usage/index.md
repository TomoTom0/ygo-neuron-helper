# 遊戯王デッキヘルパー - 使い方

遊戯王カードデータベースのデッキ管理を支援するChrome拡張の使い方をページ、機能、ボタンの順に説明します。

## 対象サイト

- **遊戯王カードデータベース**: https://www.db.yugioh-card.com/

## 機能一覧（ページ別）

### 1. デッキ表示ページ

**URL**: `https://www.db.yugioh-card.com/yugiohdb/member_deck.action?ope=1&...`

デッキ表示ページでは、以下の2つの機能が利用できます。

### 2. デッキ編集ページ

**URL**: `https://www.db.yugioh-card.com/yugiohdb/#/ytomo/edit`

デッキ編集ページは、カードの検索、デッキの編集、カード情報の確認を一つの画面で行える統合UIです。

#### 2.1 レイアウト構成

デッキ編集ページは以下のエリアで構成されています：

**左側エリア（デスクトップ表示時）**
- **TopBar**: DNO（デッキ番号）入力、デッキ名編集、Load/Saveボタン
- **Main Deck**: メインデッキのカード（最大60枚）
- **Extra Deck & Side Deck**: エクストラデッキ（最大15枚）とサイドデッキ（最大15枚）を横並び表示
- **Trash**: 削除したカードの一時保管場所

**右側エリア（RightArea）**
- **Deckタブ**（モバイル時のみ表示）: 画面幅が狭い時、デッキエリアをここに表示
- **Searchタブ**: カード検索機能
- **Cardタブ**: 選択したカードの詳細情報

**検索入力エリア**
- 画面下部に固定表示される検索バー

#### 2.2 レスポンシブデザイン

**デスクトップ表示（幅768px以上）**
- 左側にデッキエリア、右側にSearch/Cardタブを表示
- RightAreaは幅320pxで固定

**モバイル表示（幅768px以下）**
- デッキエリアが非表示になり、RightAreaに「Deckタブ」が追加表示
- RightAreaが画面幅100%に拡大
- Deckタブ内にデッキエリア全体が表示される

#### 2.3 デッキ読み込み・保存機能

**Load（読み込み）**
1. TopBarのDNO入力欄にデッキ番号を入力
2. Loadボタンをクリック
3. 指定したデッキが読み込まれます

**Save（保存）**
1. デッキを編集
2. Saveボタンをクリック
3. デッキが保存されます

#### 2.4 カード検索機能（Searchタブ）

**検索方法**
1. 画面下部の検索入力欄にカード名を入力
2. Enterキーを押すか、検索ボタン（虫眼鏡アイコン）をクリック
3. 検索結果がSearchタブに表示されます

**表示モード切り替え**
- **リスト表示**: カード画像と詳細情報を縦に並べて表示
- **グリッド表示**: カード画像のみをグリッド状に表示
- ツールバーの表示切り替えボタンで切り替え可能

**ソート機能**
ツールバーのドロップダウンで以下の順序に並び替え：
- Newer（新しい順）
- Older（古い順）
- Name (A-Z)（名前昇順）
- Name (Z-A)（名前降順）

**無限スクロール**
検索結果が多い場合、スクロールすることで追加のカードが自動的に読み込まれます。

#### 2.5 カード詳細表示（Cardタブ）

カードを選択すると、Cardタブに詳細情報が表示されます。

**タブ構成**
- **Info**: カード基本情報（効果テキスト、属性、種族など）
- **QA**: カードに関する裁定・FAQ
- **Related**: 関連カード
- **Products**: 収録商品情報

#### 2.6 デッキ編集操作

**カードの追加**
- 検索結果からカードをドラッグ＆ドロップでデッキに追加
- または検索結果のカードをクリックしてメニューから追加

**カードの移動**
- デッキ内のカードをドラッグ＆ドロップで別のセクションに移動
- Main ↔ Extra ↔ Side ↔ Trash 間で自由に移動可能

**カードの削除**
- カードをTrashセクションにドラッグ＆ドロップ
- Trashから戻すことも可能

#### 2.7 テーマカラー

デッキ編集ページでは、拡張機能のテーマカラー（青緑→赤紫グラデーション）が使用されています：
- アクティブなタブは青緑から赤紫のグラデーション背景
- 統一されたビジュアルデザイン

---

### 旧: 1. デッキ表示ページ

**URL**: `https://www.db.yugioh-card.com/yugiohdb/member_deck.action?ope=1&...`

デッキ表示ページでは、以下の2つの機能が利用できます。

#### 1.1 カードシャッフル機能

デッキのカード順序をランダムに並べ替えたり、元に戻したりする機能です。特定のカードをロックして、シャッフルの影響を受けないように固定することもできます。

![シャッフル・ソート・固定機能のデモ](./images/shuffle-sort-animation.gif)

##### ボタン

![シャッフル・ソートボタン](./images/shuffle-sort-buttons.png)

**シャッフルボタン**
- **位置**: メインデッキの枚数表示の左側
- **アイコン**: シャッフルアイコン（矢印が交差）
- **ツールチップ**: 「シャッフル」
- **機能**: ロックされていないカードをランダムに並べ替える

**ソートボタン**
- **位置**: メインデッキの枚数表示の左側（シャッフルボタンの右）
- **アイコン**: ヒストグラム昇順アイコン（棒グラフ）
- **ツールチップ**: 「元に戻す」
- **機能**: シャッフルしたカードを元の順序に戻す（ロックは解除されません）

##### 使い方

**カードをシャッフルする**
1. デッキ表示ページを開く
2. 「シャッフル」ボタンをクリック
3. ロックされていないカードがランダムに並べ替わります
4. メインデッキ、エクストラデッキ、サイドデッキすべてに適用されます

**元の順序に戻す**
1. シャッフル後、「元に戻す」ボタンをクリック
2. カードが元の順序に戻ります（ロックされたカードはそのまま）

**カードをロックする（先頭固定）**

![カードのロック機能（クリック位置）](./images/card-lock-feature.png)

1. カード画像の右上1/4のエリアをクリック
2. カードがロック状態になり、以下の表示になります：
   - 薄い青緑色の背景
   - 右上に南京錠アイコン（青緑線・黒グレー縁取り）

![カードがロックされた状態](./images/card-locked-state.png)

3. ロックされたカードはデッキの先頭に移動し、シャッフル時も順序が保持されます
4. もう一度右上1/4のエリアをクリックするとロックが解除されます

**ロック機能の詳細**
- ロックされたカードは常にデッキの先頭に配置されます
- シャッフル時、ロックされていないカードのみがランダムに並べ替わります
- 複数のカードをロックした場合、ロックした順序が保持されます
- ソートボタンを押してもロック状態は維持されます

#### 1.2 デッキ画像作成機能

デッキレシピの画像を作成してダウンロードする機能です。

##### ボタン

![デッキ画像作成ボタン](./images/deck-image-button.png)

**デッキ画像作成ボタン**
- **位置**: ページ下部の `#bottom_btn_set` エリア（右端）
- **アイコン**: カメラアイコン
- **ツールチップ**: 「デッキ画像作成」
- **機能**: デッキ画像作成ダイアログを開く

##### 使い方
1. デッキ表示ページを開く
2. 「デッキ画像作成」ボタン（カメラアイコン）をクリック
3. デッキ画像作成ダイアログが表示されます（詳細は後述）

---


---

## デッキ画像作成ダイアログ

デッキ画像作成ボタンをクリックすると表示されるダイアログの詳細です。

![デッキ画像作成ダイアログのデモ](./images/deck-image-dialog.gif)

### オプション（設定項目）

**デッキ名入力欄**
- **位置**: ダイアログ上部
- **機能**: デッキ名を編集できます
- **デフォルト値**: 現在のデッキ名
- **使い方**: 入力欄をクリックして、任意のデッキ名に変更できます

**背景色の選択**
- **位置**: ダイアログ中央（プレビュー画像）
- **機能**: 画像の背景色を選択できます
- **選択肢**: 赤 ↔ 青
- **使い方**: ダイアログ全体（プレビュー画像部分）をクリックすると背景色が切り替わります

| 赤背景 | 青背景 |
|--------|--------|
| ![赤背景](./images/image-dialog-color-red.png) | ![青背景](./images/image-dialog-color-blue.png) |

**プレビュー画像**
- **位置**: ダイアログ中央
- **機能**: 設定した内容で作成される画像のプレビューを表示
- **表示内容**: デッキ名、背景色、QRコードの有無が反映されます

### ボタン

**QRトグルボタン**
- **位置**: ダイアログ右下
- **アイコン**: QRコードアイコン + 「QR」テキスト
- **機能**: QRコードの表示/非表示を切り替え
- **状態**:
  - **ON（青色）**: QRコードを画像に含める（デフォルト）
  - **OFF（グレー）**: QRコードを画像に含めない
- **使い方**: QRボタンをクリックして切り替え。ON/OFFの状態がボタンの色で視覚的に確認できます

| QR ON | QR OFF |
|-------|--------|
| ![QR ON](./images/image-dialog-qr-on.png) | ![QR OFF](./images/image-dialog-qr-off.png) |

**ダウンロードボタン**

![ダウンロードボタン](./images/image-dialog-download-button.png)

- **位置**: ダイアログ左下
- **アイコン**: ダウンロードアイコン
- **機能**: 設定した内容で画像を生成してダウンロード
- **使い方**:
  1. デッキ名、背景色、QRコード表示を設定
  2. ダウンロードボタンをクリック
  3. ボタンがスピナーアイコンに変わり、画像生成が開始されます
  4. 画像が自動的にダウンロードされます
  5. ダイアログが自動的に閉じます

**ダイアログを閉じる**
- **方法**: ダイアログの外側（背景のオーバーレイ）をクリック
- **機能**: 画像をダウンロードせずにダイアログを閉じます

---

## 操作フロー例

### 例1: デッキ画像を作成してダウンロード

1. デッキ表示ページまたはデッキ編集ページを開く
2. 「デッキ画像作成」ボタン（カメラアイコン）をクリック
3. デッキ名を編集（必要に応じて）
4. ダイアログ全体をクリックして背景色を選択（赤または青）
5. QRボタンをクリックしてQRコードのON/OFFを選択
6. ダウンロードボタンをクリック
7. 画像がダウンロードされ、ダイアログが閉じます

### 例2: デッキをシャッフル

1. デッキ表示ページを開く
2. 「シャッフル」ボタンをクリック
3. カードの順序がランダムに並べ替わります
4. 元に戻したい場合は「元に戻す」ボタンをクリック

---

## 注意事項

- **対象ページ**: この拡張機能は遊戯王カードデータベースの以下のページでのみ動作します
  - デッキ表示ページ（`ope=1`）
  - デッキ編集ページ（`ope=2`）
- **ログイン**: デッキ機能を利用するには、遊戯王カードデータベースにログインしている必要があります
- **画像生成**: ダウンロードボタンをクリックすると、画像生成が開始されます。完了するまでしばらくお待ちください（ボタンがスピナーアイコンに変わります）

---

## トラブルシューティング

### ボタンが表示されない

- ページが完全に読み込まれるまで待ってください
- ページをリロードしてみてください
- 拡張機能が有効になっているか確認してください（chrome://extensions/）

### ダウンロードが開始されない

- ブラウザのダウンロード設定を確認してください
- ポップアップブロッカーが有効になっていないか確認してください

---

## バージョン情報

- **現在のバージョン**: 0.2.0
- **対応ブラウザ**: Google Chrome, Chromium（Manifest V3対応）
