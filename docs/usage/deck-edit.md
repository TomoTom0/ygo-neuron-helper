# デッキ編集機能

## 概要

遊戯王公式カードデータベースのデッキ詳細ページに、インタラクティブなデッキ編集UIを追加します。

## UIの全体構成

デッキ編集画面は、左側にデッキエリア、右側にカード検索・詳細表示エリアの2カラム構成です。

![デッキ編集画面の全体構成](./images/deck-edit/01-initial-state.png)

**画面構成:**
- **左側**: デッキエリア（メインデッキ、エクストラデッキ、サイドデッキ）
- **右側**: 3つのタブでカード検索・詳細表示
  - **Header**: デッキ名入力、保存/削除ボタン
  - **Search**: カード検索機能
  - **Card**: カード詳細情報表示（Info/Related/Products/Q&A）

## 機能

### 1. ドラッグ&ドロップでカード移動

カードをドラッグして別のデッキエリアにドロップすることで、簡単にカードを移動できます。

**対応エリア:**
- メインデッキ
- エクストラデッキ
- サイドデッキ

**使い方:**
1. カードをクリック&ホールド
2. 移動先のエリアまでドラッグ
3. ドロップ

### 2. カード検索エリア

デッキに追加したいカードを検索できます。

**検索方法:**
- カード名で検索
- 属性・種族・レベルなどで絞り込み

**カードの追加:**
- 検索結果のカードをクリックして `+1` ボタンでデッキに追加

![カード検索機能](./images/deck-edit/07-search-function.png)

**使い方:**
1. 右側の「Search」タブをクリック
2. 検索欄にカード名を入力（例: 「ブラック・マジシャン」）
3. 検索ボタンをクリック
4. 検索結果からカードを選択してデッキに追加

### 3. カード枚数調整

各カードの右側に表示されるボタンで枚数を調整できます。

**ボタン:**
- **+1**: 同じカードを1枚追加
- **-1**: カードを1枚削除
- **🗑️**: 同じカードをすべて削除
- **→S**: サイドデッキに移動

### 4. 公式並び順ソート

デッキを公式サイトの並び順（モンスター→魔法→罠）にソートできます。

**ソート順:**
1. モンスターカード（レベル/ランク降順）
2. 魔法カード（カード名昇順）
3. 罠カード（カード名昇順）

**使い方:**
- デッキセクション右上の「公式並び順」ボタンをクリック

### 5. 表示モード切り替え

カードの表示方法を切り替えられます。

**モード:**
- **リスト表示**: カード名と枚数を一覧表示（デフォルト）
- **グリッド表示**: カード画像をタイル状に表示

**切り替え方法:**
- カードリスト右上の切り替えボタンをクリック

### 6. スムーズなアニメーション

カードの移動や追加・削除時に、視覚的にわかりやすいアニメーションが表示されます。

### 7. カード詳細表示

デッキに含まれるカードを選択すると、右側のCardタブにカード詳細情報が表示されます。

**表示内容:**
- **Info**: カードの基本情報（属性、種族、レベル、攻撃力/守備力、テキストなど）
- **Related**: 関連カード一覧
- **Products**: このカードを収録しているパック・商品一覧
- **Q&A**: このカードに関する公式Q&A

#### Info タブ

カードの基本情報を表示します。

![カード詳細 - Info](./images/deck-edit/03-card-detail-info.png)

#### Related タブ

関連カード（同じシリーズ、サポートカードなど）を表示します。

![カード詳細 - Related](./images/deck-edit/04-card-detail-related.png)

#### Products タブ

このカードが収録されているパック・商品の一覧を表示します。

![カード詳細 - Products](./images/deck-edit/05-card-detail-products.png)

#### Q&A タブ

このカードに関する公式Q&Aを表示します。質問をクリックすると回答が展開されます。

![カード詳細 - Q&A](./images/deck-edit/06-card-detail-qa.png)

## 対応言語

- **日本語**: 完全対応
- **英語**: 完全対応

言語は自動検出されます。

## Q&A (よくある質問)

カード詳細ページから取得したQ&A情報を表示します。

**機能:**
- Q&A一覧の表示
- 展開/縮小ボタンで詳細表示切り替え
- 日付表示

## 使用例

### 基本的なデッキ編集フロー

1. デッキ詳細ページを開く
2. デッキ編集UIが自動的に表示される
3. Headerタブでデッキ名を編集

![デッキ名の入力](./images/deck-edit/02-deck-name-input.png)

4. 検索エリアでカードを検索
5. 検索結果から `+1` ボタンでデッキに追加
6. ドラッグ&ドロップでカードを整理
7. 「公式並び順」でソート
8. 完成したデッキを確認

### カードの削除

1. 削除したいカードを探す
2. カード右側の `-1` ボタンで1枚削除
3. または `🗑️` ボタンで全削除

### サイドデッキへの移動

1. サイドに移動したいカードを探す
2. カード右側の `→S` ボタンをクリック
3. カードがサイドデッキに移動

## 注意事項

### デッキ枚数制限

- **メインデッキ**: 40〜60枚
- **エクストラデッキ**: 0〜15枚
- **サイドデッキ**: 0〜15枚
- **同じカード**: メイン・エクストラ・サイド合計で最大3枚まで

※ 同じカードをメイン・エクストラ・サイドに合計3枚まで追加できます。4枚目を追加しようとすると無効化されます。  
※ 現在、禁止・制限カードのチェックは実装されていません。

### 保存機能

現バージョンでは、編集内容は**保存されません**。
デッキの編集はプレビュー用途として使用してください。

将来のバージョンで保存機能を追加予定です。

## トラブルシューティング

### Q: デッキ編集UIが表示されない

**A:** 以下を確認してください:
- 拡張機能が有効になっているか
- デッキ詳細ページにアクセスしているか
- ページを再読み込みしてみる

### Q: カードをドラッグできない

**A:** 
- ブラウザのバージョンを確認
- ページを再読み込み
- 一度カードをクリックしてから再試行

### Q: アニメーションが遅い

**A:**
- ブラウザのハードウェアアクセラレーションを有効化
- 他のタブを閉じてリソースを確保

### Q: 英語版で正しく動作しない

**A:**
- 言語が正しく検出されているか確認
- コンソールにエラーが出ていないか確認
- Issue を報告

## フィードバック

バグ報告や機能要望は、GitHubのIssueでお願いします。

## 次のステップ

- [シャッフル機能](./index.md#カードのシャッフル)
- [デッキ画像作成](./index.md#デッキ画像作成)
