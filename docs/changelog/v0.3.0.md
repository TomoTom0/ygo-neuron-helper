# v0.3.0 - 2025-11-13

## 新機能

### 独自デッキ編集画面 (#/ytomo/edit)
- **基本機能**
  - DNO入力によるデッキロード機能
  - デッキ保存機能（Main/Extra/Side/Trash）
  - カードドラッグ＆ドロップによる移動
  - カード枚数制限（同一カードはMain/Extra/Side合計で3枚まで）

- **カード検索機能**
  - 名前・属性・種族・レベル・ATK/DEFによる検索
  - ソート機能（新しい順/古い順/名前順）
  - リスト/グリッド表示切り替え
  - 無限スクロール対応

- **カード詳細表示**
  - **Infoタブ**: カード基本情報・ステータス表示
  - **Relatedタブ**: 関連カード一覧（リスト/グリッド切り替え対応）
  - **Productsタブ**: 収録パック一覧（展開/折りたたみ機能付き）
  - **QAタブ**: Q&A一覧（展開/折りたたみ機能付き）

- **UI/UX改善**
  - レスポンシブデザイン（モバイル対応）
  - FLIPアニメーション（カード移動時）
  - タブ切り替えアニメーション
  - スクロール最適化（スムーズスクロール、自動上スクロール）
  - ボタン色分け（機能別に視認性向上）
  - テーマカラー統一（青緑→赤紫グラデーション）

### 多言語対応基盤

- **言語自動検出**
  - `#nowlanguage`要素、meta og:url、URLパラメータから自動検出
  - 対応言語: 日本語、英語（他言語も拡張可能）

- **マッピングテーブル**
  - 属性・種族・エフェクトタイプの多言語マッピング
  - 自動生成スクリプト（`scripts/setup/generate-card-maps.ts`）

- **API多言語対応**
  - `getCardDetail`: 言語引数追加、省略時は自動検出
  - `saveDeckInternal`: request_locale自動検出
  - `getDeckDetail`: request_locale自動検出
  - `getDeckListInternal`: request_locale自動検出

### オプションページ拡張

- **Omit and Usageタブ**
  - シャッフル機能の説明（デモGIF付き）
  - デッキ画像作成機能の説明（作成見本付き）
  - 独自デッキ編集画面のON/OFF設定
  - 各機能のON/OFF切り替え

- **Deck Edit Settingsタブ**（将来的に有効化予定）
  - デフォルト表示モード設定（リスト/グリッド）
  - デフォルトソート順設定
  - アニメーション有効化/無効化
  - 言語設定（自動/手動選択）

## 改善

### UI/UX
- Grid表示時のカード画像サイズ拡大（36px→60px）
- リンクマーカー表示の改善（直角二等辺三角形に統一、配置修正）
- スクロールバー常時表示（レイアウトずれ防止）
- Q&A/収録パック展開時の自動スクロール調整
- CardListコンポーネントによるカード表示の統一

### パフォーマンス
- CardList.vueのheight指定削除（内容に合わせた高さに）
- scrollToTopをemitベースに変更（DOM依存解消）
- 無限スクロール実装（検索結果の遅延ロード）

### コード品質
- 型定義改善（imageId → ciid に統一、必須化）
- `getCardImageUrl`関数の追加（型と密結合）
- コンポーネント分離（CardQA.vue、CardProducts.vue）
- 不要なconsole.log削除
- コメントアウトコード削除

## バグ修正

- リンクマーカーのビット位置マッピング修正
- deck-areasの下部マージン追加（検索エリアで隠れない対策）
- DeckSectionの余計な空白削除（drop-zone-endのmin-height調整）
- stat-box-typeの横スクロール問題修正（幅95%に調整）
- pack-detailsのオーバーフロー防止（text-overflow: ellipsis）

## 内部変更

### 状態管理
- Piniaストア実装（deck-edit.ts）
- displayOrder管理（UUID付きカード配列）
- FLIPアニメーション対応

### テスト
- **単体テスト**: 47 tests（tsx実行）
- **結合テスト**: 34 tests（tsx実行）
- **コンポーネントテスト**: 51 passed / 3 skipped（vitest）
- **合計**: 125 tests 全pass

### ビルド・デプロイ
- vitestサポート追加（__dirname polyfill）
- Vueコンポーネントテスト環境整備

## ドキュメント

### 新規作成
- `docs/usage/deck-edit.md`: デッキ編集画面の使い方
- `docs/dev/architecture.md`: アーキテクチャ解説
- `docs/dev/i18n.md`: 多言語対応の実装方法
- `docs/research/i18n-investigation.md`: 多言語調査結果

### 更新
- `README.md`: v0.3.0新機能の説明
- `docs/usage/index.md`: デッキ編集画面・オプションページの説明
- `docs/api/card-search.md`: 多言語対応パラメータ追加
- `docs/dev/README.md`: テスト実行方法の詳細化

### アーカイブ化
- 陳腐化したドキュメントを `docs/_archived/` に移動
  - `chrome-extension-architecture.md`
  - `implementation-design.md`
  - `implementation-guide.md`

## 既知の問題・制限事項

### 機能制限
- デッキ保存のダイアログ実装は未完成（次バージョンで対応予定）
- 収録パック展開時のカードリストはキャッシュされない（毎回取得）
- 無限スクロールの最適化が不十分（最適化タスクとしてpending.mdに記載）

### ブラウザ制限
- Playwrightのブラウザではログインできない制約あり（Chromium + CDPで対応）

### 多言語対応
- 現在は日本語・英語のみサポート
- 韓国語・中国語などは検証未完了

### テスト
- E2Eテストは未実装（次バージョンで対応予定）

## アップグレード方法

1. 拡張機能をアップデート
2. オプションページを開き、独自デッキ編集画面を有効化
3. https://www.db.yugioh-card.com/yugiohdb/#/ytomo/edit にアクセス

## 謝辞

PR#2のレビューにご協力いただいた皆様、ありがとうございました。

---

**前バージョン**: [v0.2.0](./v0.2.0.md)
**次バージョン**: v0.4.0（計画中）
