# カード検索パラメータ完全仕様

## 調査日時
2025-10-30

## 概要
遊戯王DBのカード検索機能は、140個のフィールドを持つ非常に詳細な検索システムである。
本ドキュメントでは、全パラメータとその意味、取りうる値を文書化する。

## 基本パラメータ

### システムパラメータ
| パラメータ | 説明 | 値 |
|-----------|------|-----|
| `ope` | 操作コード | `1` = 検索結果 |
| `sess` | セッション識別子 | 数値（1, 2, 3...） |
| `rp` | 結果件数/ページ | `10`, `25`, `50`, `100`（推定） |
| `mode` | モード | 空文字列または特定の値 |
| `sort` | ソート順 | `1` = デフォルト、その他の値は要調査 |

### 検索対象パラメータ
| パラメータ | 説明 | 取りうる値 |
|-----------|------|-----------|
| `keyword` | 検索キーワード | 任意の文字列 |
| `stype` | 検索タイプ | `1`=カード名検索, `2`=カードテキスト検索, `3`=ペンデュラム効果検索, `4`=カードNo検索 |
| `ctype` | カードタイプ | 空=すべて, `1`=モンスター, `2`=魔法, `3`=罠 |

## カード属性パラメータ

### 属性 (attr)
複数選択可能（checkbox）

| 値 | 属性名 |
|----|--------|
| `11` | 光属性 |
| `12` | 闇属性 |
| `13` | 水属性 |
| `14` | 炎属性 |
| `15` | 地属性 |
| `16` | 風属性 |
| `17` | 神属性 |

### 種族 (species)
複数選択可能（checkbox）、計26種類

| 値 | 種族名 |
|----|--------|
| `1` | ドラゴン族 |
| `2` | アンデット族 |
| `3` | 悪魔族 |
| `4` | 炎族 |
| `5` | 海竜族 |
| `6` | 岩石族 |
| `7` | 機械族 |
| `8` | 魚族 |
| `9` | 恐竜族 |
| `10` | 昆虫族 |
| `11` | 獣族 |
| `12` | 獣戦士族 |
| `13` | 植物族 |
| `14` | 水族 |
| `15` | 戦士族 |
| `16` | 鳥獣族 |
| `17` | 天使族 |
| `18` | 魔法使い族 |
| `19` | 雷族 |
| `20` | 爬虫類族 |
| `21` | サイキック族 |
| `22` | 幻神獣族 |
| `23` | 創造神族 |
| `26` | 幻竜族 |
| `27` | サイバース族 |
| `34` | 幻想魔族 |

### 魔法/罠カード効果 (effe)
複数選択可能（checkbox）

| 値 | 効果名 |
|----|--------|
| `20` | 通常 |
| `21` | カウンター |
| `22` | フィールド |
| `23` | 装備 |
| `24` | 永続 |
| `25` | 速攻 |
| `26` | 儀式 |

## 数値範囲パラメータ

### レベル/ランク指定
- `starfr`: レベル/ランク範囲（開始）
- `starto`: レベル/ランク範囲（終了）
- 個別指定: `level0` ~ `level13`（checkbox）

### ペンデュラムスケール
- `pscalefr`: Pスケール範囲（開始）
- `pscaleto`: Pスケール範囲（終了）
- 個別指定: `Pscale0` ~ `Pscale13`（checkbox）

### リンク
- `linkmarkerfr`: リンク数範囲（開始）
- `linkmarkerto`: リンク数範囲（終了）
- リンク数指定: `Link1` ~ `Link6`（checkbox）
- リンクマーカー: `linkbtn1` ~ `linkbtn9`（checkbox）
  - 各ボタンは特定の方向を表す（上、下、左、右、斜めなど）
- `link_m`: リンクマーカー関連の追加パラメータ（2個）

### 攻撃力/守備力
- `atkfr`: 攻撃力範囲（開始）
- `atkto`: 攻撃力範囲（終了）
- `deffr`: 守備力範囲（開始）
- `defto`: 守備力範囲（終了）

## 発売日パラメータ
- `releaseYStart`: 発売年（開始）
- `releaseMStart`: 発売月（開始、1-12）
- `releaseDStart`: 発売日（開始、1-31）
- `releaseYEnd`: 発売年（終了）
- `releaseMEnd`: 発売月（終了、1-12）
- `releaseDEnd`: 発売日（終了、1-31）

## その他の条件

### その他条件 (other)
15個のチェックボックス
- 内容は要調査（モンスター種類、特殊召喚条件など）

### 除外条件 (jogai)
15個のチェックボックス
- 内容は要調査（特定条件の除外など）

### その他 (othercon)
2個のパラメータ
- 内容は要調査

## 統計
- **総フィールド数**: 140個
- **hidden**: 11個
- **text**: 5個
- **select**: 8個
- **checkbox**: 112個
- **radio**: 4個

## 調査状況

### 完了
- [x] 基本検索フォーム構造の確認
- [x] 全フィールドの特定（140個）
- [x] 属性、種族、効果のマッピング
- [x] selectフィールドの選択肢取得
- [x] 公式JSファイルのダウンロード

### 今後の調査が必要
- [ ] `other` (その他条件) 15個の詳細
- [ ] `jogai` (除外条件) 15個の詳細
- [ ] リンクマーカー `linkbtn1-9` の方向マッピング
- [ ] 実際の検索操作でのURL変化の記録
- [ ] パラメータの組み合わせルールの確認
- [ ] ソート順の全選択肢

## 成果物
- `tmp/search-form-fields.json`: 全フィールドの生データ
- `tmp/search-field-label-mappings.json`: ラベルとvalueのマッピング
- `tmp/js-files/`: ダウンロードしたJSファイル

## 次のステップ
1. 残りのチェックボックス（other, jogai）のラベル取得
2. 様々な検索条件での実際の検索実行とURL記録
3. パラメータの動作確認
4. 完全な仕様書の完成
